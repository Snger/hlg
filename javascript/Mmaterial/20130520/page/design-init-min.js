KISSY.add("utils/showPages/index",function(a){function e(a){var b=this;if(!(b instanceof e))return new e(a);this.pageNum=4,this.name=a,this.page=1,this.pageCount=200,this.argName="page"}var b=a.DOM,c=a.Event,d=document;return a.mix(e.prototype,{jump:function(){return undefined},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},_createHtml:function(a){var b=this,c="",d=this.page-1,e=this.page+1;if(a==""||typeof a=="undefined")a=1;switch(a){case 1:c+='<span class="number">',this.page!=1&&(c+='<span title="Page 1"><a href="javascript:'+b.name+'.toPage(1);">1</a></span>'),this.page>=5&&(c+="<span>...</span>");if(this.pageCount>this.page+2)var f=this.page+2;else var f=this.pageCount;for(var g=this.page-2;g<=f;g++)g>0&&(g==this.page?c+='<span title="Page '+g+'">'+g+"</span>":g!=1&&g!=this.pageCount&&(c+='<span title="Page '+g+'"><a href="javascript:'+b.name+".toPage("+g+');">'+g+"</a></span>"));this.page+3<this.pageCount&&(c+="<span>...</span>"),this.page!=this.pageCount&&(c+='<span title="Page '+this.pageCount+'"><a href="javascript:'+b.name+".toPage("+this.pageCount+');">'+this.pageCount+"</a></span>"),c+="</span><br />";break;case 2:if(this.pageCount>1){c+='<div class="page-bottom"> <div class="sabrosus">',d<1?c+='<span class="pre-none page-pic-no"></span>':c+='<a class="" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',this.page==1;if(this.page-2<=0){var h=1;if(this.pageCount>this.page+4)var f=this.page+4;else var f=this.pageCount}else if(this.page+2>=this.pageCount){var h=this.pageCount-4;if(this.pageCount>this.page+4)var f=this.page+4;else var f=this.pageCount}else{var h=this.page-2;if(this.pageCount>this.page+2)var f=this.page+2;else var f=this.pageCount}for(var g=h;g<=f;g++)g>0&&(g==this.page?c+='<span class="current a-padding">'+g+"</span>":c+='<a class="a-padding" href="javascript:'+b.name+".toPage("+g+');">'+g+"</a>");this.page+5<this.pageCount&&(c+='<a class="a-padding" title="" href="javascript:'+b.name+".toPage("+(this.page+3)+');">...</a>'),this.page==this.pageCount,e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a class="" href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',this.pageCount>5&&(c+='<font class="number">',c+="\u5171"+this.pageCount+"\u9875&nbsp;\u5230\u7b2c&nbsp;",this.page>=this.pageCount?c+='<input style="" type="text" class="page-pic-no w-30 bg-img" id="pageInput'+b.name+'"  value="'+this.pageCount+'" onkeypress="return window.'+b.name+'.formatInputPage(event);" onfocus="this.select()">&nbsp;\u9875':c+='<input style="" type="text" class="page-pic-no w-30 bg-img" id="pageInput'+b.name+'"  value="'+(this.page+1)+'" onkeypress="return window.'+b.name+'.formatInputPage(event);" onfocus="this.select()">&nbsp;\u9875',c+='<input type="button" value="" class="page-pic-no gray-btm-h-go w-30 btm-go" onclick="javascript:var page = document.getElementById(\'pageInput'+b.name+"').value; if(isNaN(Number(page))|| Number(page)==0) { var turnTo = 1;} else if(page>"+this.pageCount+"){ var turnTo = "+this.pageCount+";} else{var turnTo = page;}  window."+b.name+'.toPage(turnTo);">',c+="</font>"),c+='<div style="clear:both"></div></div></div> '}break;case 3:c+='<div class="page-top"><div class="sabrosus"><span class="count">'+this.page+" / "+this.pageCount+"</span>",d<1?c+=' <span class="pre-none page-pic-no"></span>':c+='<a class="border-left-dedede" href="javascript:'+b.name+".toPage("+d+');" title="\u4e0a\u4e00\u9875"><span class="pre page-pic-no"></span></a>',e>this.pageCount?c+='<span class="next-none page-pic-no"></span>':c+='<a href="javascript:'+b.name+".toPage("+e+');" title="\u4e0b\u4e00\u9875"><span class="next page-pic-no"></span></a>',c+='<div style="clear:both"></div></div></div>'}return c},formatInputPage:function(a){var b=navigator.appName=="Microsoft Internet Explorer"?!0:!1;if(!b)var c=a.which;else var c=event.keyCode;return c==8||c==46||c>=48&&c<=57?!0:!1},toPage:function(a,b){var c=1,d=this;typeof a=="object"?c=a.options[a.selectedIndex].value:c=a,d.jump(c,b,"")},printHtml:function(a,c){return this.checkPages(),b.html(a,this._createHtml(c)),this},setPageCount:function(a){return this.pageCount=a,this},getPageCount:function(){return this.pageCount},setRender:function(a){return this.jump=a,this},setPageNum:function(a){return this.pageNum=a,this},setPage:function(a){return this.page=a,this}}),e}),KISSY.add("page/mods/tshop",function(a){function p(a){if(f&&6===f){a=b.get(a);if(!a)return;c.add(a,"mouseenter",function(a){b.addClass(this,"hover")}),c.add(a,"mouseleave",function(a){b.removeClass(this,"hover")})}}function q(a){var b=e.createElement("bar"),c=e.createElement("barbd"),d=e.createElement("baracts"),f='<a href="#2" class="ds-bar-%CLASS" title="%TITLE"><span>%TITLE</span></a>',g="",h=/%TITLE/g,i=/%CLASS/;return g+=f.replace(h,"\u7f16\u8f91").replace(i,"edit"),g+=f.replace(h,"\u5220\u9664").replace(i,"del"),d.innerHTML=g,b.appendChild(c),b.appendChild(d),b}var b=a.DOM,c=a.Event,d=window,e=document,f=a.UA.ie,g="data-id",h="data-uri",i="data-render",j="data-width",k="ds-bar-moveup",l="ds-bar-movedown",m="no-move-up",n="no-move-down",o=null;return window.g_ds_del_list=[],IF={reflowbar:function(a,c,d){if(!a)return;var e,f,g,h="height",i="tb-minimize",j="position",k="relative",l;l=b.children(a),c||(c=l[l.length-1]),l.length>0&&l[l.length-1].tagName.toLowerCase()==="bar"&&l.pop(),b.css(l,h,""),g=parseFloat(b.css(a,"padding-bottom")),e=(d||b.height(a))-g,f=e,e=b.height(a),b.css(a,h,e),b.css(c,{height:e,"margin-top":-e}),b.css(b.children(c)[0],{height:e-4,width:a.offsetWidth-4})},_initMod:function(a){var d=this,e=q(a);d.reflowbar(a,e),a.appendChild(e),f&&c.add(a,"mouseenter",function(a){b.removeClass(this,"fix-ie-hover")}),p(e)},init:function(a){var b=this;b._initMod(a)}}},{requires:[]}),KISSY.add("page/mods/listParam",function(a){return listParam={init:function(){var b="",c="",d="",e="",f="",g="",h="",i="",j="",k="",l="",m="",n="",o="",q="";a.each(list.listParams,function(b){b["field_code"]=="color"&&(d+='<li class="min-height-40 J_ListParams" ><input type="hidden" id ="J_color"  value="'+b.value+'"  class="J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>'+'<div class="active-add-edit-title" style="width:16%;">\u5217\u8868\u989c\u8272\u9009\u62e9\uff1a</div>'+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px">',paramOptons.color&&a.each(paramOptons.color,function(a,c){clos=a.split("_"),d+='<span class="list-template-color J_SelectColor ',b["value"]==a&&(d+="a-current"),d+='" data="'+a+'" >',d+='<b style="background: #'+clos[0]+'"></b>',d+="</span>"}),paramOptons["color"].length==1&&(d+='<span style="font-size:12px;"><!--\uff08\u8bf4\u660e\uff1a\u6b64\u6a21\u7248\u4e3a\u65e7\u6a21\u7248\u4e0d\u652f\u6301\u591a\u8272\u7cfb,\u6301\u7eed\u66f4\u65b0\u4e2d\uff09--></span>'),d+="</div></li>");if(b["field_code"]=="items_per_line"){c+='<li class="min-height-40 J_ListParams">',c+='<div class="active-add-edit-title" style="width:16%;">';if(mtype==7){c+="\u89c4\u683cx\u5bbd\u5ea6x\u4e2a\u6570";if(items_per_line=="")var r=b.value;else var r=items_per_line;var s=r.split("_");limit=parseInt(s[3])}else{c+="\u6a21\u677f\u5bbd\u5ea6";var r=b.value;limit=parseInt(limitNums[r.substr(0,3)])}c+='\uff1a</div><div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" id ="J_items_per_line_default"  value="'+r+'">'+'<input type="hidden" id ="J_items_per_line"  value="'+r+'"  class="J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>';if(mtype==7){var t=associateFormats.length;for(var u=0;u<t;u++){c+='<a href="#2"',r+"-"+protoId==associateFormats[u]?c+='class="on-center J_width"':c+='class="off-center J_width"';var v=associateFormats[u].substring(0,associateFormats[u].indexOf("-"));v=v.split("_"),c+='><span  class="w-100 J_list_width" id="'+associateFormats[u]+'">'+v[0]+"x"+v[2]+"x"+v[3]+"</span></a>"}c+="</div></li>"}else{p=0;for(var w in formats)b["value"].split("_")[0]==w&&(c+='<input type="hidden" id="J_frame_width" value ="'+w+'"/>'),c+='<a href="#2"',b["value"].split("_")[0]==w?c+='class="on-center J_width"':c+='class="off-center J_width"',c+='><span  class="w-100 J_list_width" id="'+w+'">'+w+"\u50cf\u7d20</span></a>";c+="</div></li>",c+='<li class="min-height-40"><div class="active-add-edit-title" style="width:16%;">\u5b9d\u8d1d\u4e3b\u56fe\u89c4\u683c\uff1a</div>';for(var w in formats){c+='<div class="active-add-edit-edit relative  J_mainSize" id="J_mainSize'+w+'" style="width:80%;margin-bottom:10px;',b["value"].split("_")[0]!=w&&(c+="display:none"),c+='">',c+='<input type="hidden" id="J_mian_size'+w+'" value ="';for(var x in formats[w]){if(b["value"].split("_")[0]!=w){c+=x;break}b["value"].split("_")[2]==x&&(c+=x)}c+='"/>';var y=1;for(var z in formats[w])c+='<a href="#2"',b["value"].split("_")[0]==w?b["value"].split("_")[2]==z?c+='class="on-center J_Mwidth"':c+='class="off-center J_Mwidth"':y==1?(c+='class="on-center J_Mwidth"',y++):c+='class="off-center J_Mwidth"',c+='><span  class="w-100 J_main_size" id="'+z+'">'+z+"</span></a>";c+="</div>"}c+="</li>",c+='<li class="min-height-40"><div class="active-add-edit-title" style="width:16%;">\u6bcf\u884c\u663e\u793a\u4ef6\uff1a</div><div class="active-add-edit-edit relative" style="width:84%;margin-bottom:10px" ><span class="list-number" ><b id="J_item_pre_line">'+b.value.split("_")[3]+"</b></span></div></li>"}}b["field_code"]=="more_link"&&(e+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">\u66f4\u591a\uff1a</div><div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',e+='<input type="text" id="J_moreLink"  class="input-text w-360 J_Param_Value" value="'+b.value+'">',e+="</div></li>");if(b["field_code"]=="quality_pics"){f+='<li class="title-params min-height-40 list-template-icon-img J_ListParams" id=""><div class="active-add-edit-title" style="width:16%;">\u54c1\u8d28\u56fe\u7247\uff1a</div><div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" id ="J_QualityPics" class="J_Param_Value" value="'+b.value+'"/>'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>';if(paramOptons.quality_pics){var A=b.value.split("#");a.each(paramOptons.quality_pics,function(b,c){f+='<a href="#2"',a.each(A,function(a){a!=""&&a==b&&(f+='class="a-current"')}),f+='><span class="J_quality_pics"><img width="50" border="0" src ="'+b+'_sum.jpg" alt=""></span></a>'})}f+="</div></li>"}b["field_code"]=="keywords"&&(g+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">\u5173\u952e\u8bcd\uff1a</div><div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',g+='<input type="text" id="J_keywords"  class="input-text w-360 J_Param_Value" value="'+b.value+'">',g+="</div></li>"),7==mtype&&(h='<li class="title-params min-height-40 clear" style="margin-top:20px">\u5982\u5728\u3010\u9009\u62e9\u5b9d\u8d1d\u3011\u9875\u9762 \u9009\u62e9\u4e86\u3010\u5b98\u65b9\u642d\u914d\u5957\u9910\u3011\uff0c\u4ee5\u4e0b\u5185\u5bb9\u4f1a\u81ea\u52a8\u586b\u5145</li>');if(b["field_code"]=="list_param1"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";i+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',i+='<input type="text" id="J_list_param1" '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',i+="</div></li>"}if(b["field_code"]=="list_param2"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";j+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',j+='<input type="text" id="J_list_param2" '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',j+="</div></li>"}if(b["field_code"]=="list_param3"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";k+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',k+='<input type="text" id="J_list_param3"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',k+="</div></li>"}if(b["field_code"]=="list_param4"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";l+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',l+='<input type="text" id="J_list_param4"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',l+="</div></li>"}if(b["field_code"]=="list_param5"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";m+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',m+='<input type="text" id="J_list_param5"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',m+="</div></li>"}if(b["field_code"]=="list_param6"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";n+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',n+='<input type="text" id="J_list_param6"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',n+="</div></li>"}if(b["field_code"]=="list_param7"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";o+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',o+='<input type="text" id="J_list_param7"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',o+="</div></li>"}if(b["field_code"]=="list_param8"){if(7==mtype)var B='title="'+b.field_name+'"';else var B="";q+='<li class="title-params min-height-40 J_ListParams" ><div class="active-add-edit-title" style="width:16%;">'+b.field_name+"\uff1a</div>"+'<div class="active-add-edit-edit" style="width:84%;margin-bottom:10px"><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',q+='<input type="text" id="J_list_param8"  '+B+' class="input-text w-360 J_Param_Value" value="'+b.value+'">',q+="</div></li>"}}),listParamsConfirmHtm="",List_itemParamExplainHtml="",List_oriPriceWriterHtml="",List_curPriceWriterHtml="",List_tinyLabelsHtml="",List_itemParam1Html="",List_itemParam2Html="",List_itemParam3Html="",List_itemParam4Html="",List_itemParam5Html="",List_itemParam6Html="",a.each(list.defaultItemParams,function(b){b["field_code"]=="ori_price_writer"&&(List_oriPriceWriterHtml+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">\u539f\u4ef7\u6587\u6848\uff1a</div><div class="active-add-edit-edit fl  mr10"><input type="text" id ="J_oriPriceWriter" value="'+b.value+'" title="\u539f\u4ef7\u6587\u6848" class="input-text w-100 J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>'+'</div><div class="fl"><select id="J_OPrice" name="oripricewriter" onchange="KISSY.DOM.val(\'#J_oriPriceWriter\',this.value)">',paramOptons.ori_price_writer&&a.each(paramOptons.ori_price_writer,function(a){List_oriPriceWriterHtml+='<option value="'+a+'">'+a+"</option>"}),List_oriPriceWriterHtml+="</select></div></li>"),b["field_code"]=="cur_price_writer"&&(List_curPriceWriterHtml+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">\u73b0\u4ef7\u6587\u6848\uff1a</div><div class="active-add-edit-edit fl mr10"><input type="text" id ="J_curPriceWriter" value="'+b.value+'" title="\u73b0\u4ef7\u6587\u6848" class="input-text w-100 J_Param_Value">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>'+'</div><div class="fl"><select id="J_CPrice" name="oripricewriter" onchange="KISSY.DOM.val(\'#J_curPriceWriter\',this.value)">',paramOptons.cur_price_writer&&a.each(paramOptons.cur_price_writer,function(a){List_curPriceWriterHtml+='<option value="'+a+'">'+a+"</option>"}),List_curPriceWriterHtml+="</select></div></li>");if(b["field_code"]=="tiny_labels"){var c=b.value.split("#");List_tinyLabelsHtml+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">\u5c0f\u6807\u7b7e\uff1a</div><div class="active-add-edit-edit fl  mr10"><input type="hidden" class="J_Param_Value" id ="J_SetTinyLabels" value="'+b.value+'"/><input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/>',paramOptons.tiny_labels&&a.each(paramOptons.tiny_labels,function(b){List_tinyLabelsHtml+='<a href="#2"',a.each(c,function(a){a!=""&&a==b&&(List_tinyLabelsHtml+='class="t-current"')}),List_tinyLabelsHtml+='><img src="'+b+'" class="J_TinyLabels" onClick="var elem = this;listParam.setAllTiny(elem)" /></a>&nbsp;&nbsp;'}),List_tinyLabelsHtml+="</div></li>"}b["field_code"]=="item_param1"&&(List_itemParam1Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param1" value="'+b.value+'" title="param1" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>'),b["field_code"]=="item_param2"&&(List_itemParam2Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param2" value="'+b.value+'" title="param2" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>'),b["field_code"]=="item_param3"&&(List_itemParam3Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param3" value="'+b.value+'" title="param3" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>'),b["field_code"]=="item_param4"&&(List_itemParam1Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param4" value="'+b.value+'" title="param4" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>'),b["field_code"]=="item_param5"&&(List_itemParam5Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param5" value="'+b.value+'" title="param5" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>'),b["field_code"]=="item_param6"&&(List_itemParam6Html+='<li class="title-params active-add-edit-li J_SetAllItem clear min-height-30" ><div class="active-add-edit-title fl w-200">'+list.defaultItemFieldNames[b.field_code]+'\uff1a</div><div class="active-add-edit-edit fl  mr10">'+'<input type="text"  name="param6" value="'+b.value+'" title="param6" class="J_Param_Value input-text w-200">'+'<input type="hidden" class="J_Param_ParamId" value="'+b.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+b.field_code+'"/></div></li>')}),ListStr=d+c+e+f+g+h+i+j+k+l+m+n+o+q+listParamsConfirmHtm,mtype==7&&meal_id==0&&(ListStr+='<li class="title-params"><div class="active-add-edit-title fl" style="width:16%;">&nbsp;</div><div class="active-add-edit-edit fl"><a href="http://bangpai.taobao.com/group/thread/609027-277801311.htm?spm=0.0.0.40.35d48a" target="_blank">\u6ca1\u6709\u94fe\u63a5\uff1f\u60a8\u53ef\u80fd\u6ca1\u8ba2\u8d2d\u5b98\u65b9\u7684\u642d\u914d\u5957\u9910\uff0c\u70b9\u51fb\u67e5\u770b\u8be6\u60c5</a></div></li>'),ItemStr=List_itemParamExplainHtml+List_oriPriceWriterHtml+List_curPriceWriterHtml+List_tinyLabelsHtml+List_itemParam1Html+List_itemParam2Html+List_itemParam3Html+List_itemParam4Html+List_itemParam5Html+List_itemParam6Html,list.defaultItemParams.length>0&&(ItemStr+='<li class="active-add-edit-li  clear min-height-30"><div class="active-add-edit-title fl w-200">&nbsp;</div><div class="active-add-edit-edit fl mr10"><a href="javascript:list.setAllItems();"><span class="gray-btm-h-20 w-100"><span>\u5e94\u7528\u5230\u4ee5\u4e0b\u5b9d\u8d1d</span></span></a><span id="J_setMsg" class="messages"></span></div></li>'),DOM.html("#J_AllItemParams",ItemStr),DOM.html("#J_listParams",ListStr),DOM.query(".J_quality_pics").length>0&&Event.on(DOM.query(".J_quality_pics"),"click",function(a){var b=DOM.attr(DOM.children(a.currentTarget)[0],"src"),c=DOM.val("#J_QualityPics");DOM.hasClass(DOM.parent(a.currentTarget),"a-current")?(c=c.replace("#"+b,""),c=c.replace(b+"#",""),c=c.replace(b,""),DOM.removeClass(DOM.parent(a.currentTarget),"a-current")):(c==""?c+=b:c+="#"+b,DOM.addClass(DOM.parent(a.currentTarget),"a-current")),DOM.val("#J_QualityPics",c)}),DOM.query(".J_SelectColor").length>0&&Event.on(DOM.query(".J_SelectColor"),"click",function(a){var b=DOM.attr(a.currentTarget,"data");DOM.removeClass(DOM.query(".list-template-color"),"a-current"),DOM.toggleClass(this,"a-current"),DOM.val("#J_color",b),list.preview()}),Event.on(DOM.query(".J_list_width"),"click",listParam.changeListOption),Event.on(DOM.query(".J_main_size"),"click",listParam.changeMainSise)},changeListOption:function(){if(mtype==7){var a=this.id;DOM.replaceClass(DOM.query(".J_width"),"on-center off-center","off-center"),DOM.replaceClass(DOM.parent(this),"on-center off-center","on-center");var b=a.split("-");DOM.val("#J_items_per_line",b[0]);var c=b[0].split("_");limit=parseInt(c[3]),b[1]!=protoId&&(window.location=dapeiUrl+b[1]+"&items_per_line="+b[0])}else{var a=this.id,d=DOM.val("#J_mian_size"+a);DOM.hide(DOM.query(".J_mainSize")),DOM.show("#J_mainSize"+a),DOM.replaceClass(DOM.query(".J_width"),"on-center off-center","off-center"),DOM.replaceClass(DOM.parent(this),"on-center off-center","on-center"),DOM.val("#J_frame_width",a),d!=""?DOM.html("#J_item_pre_line",formats[a][d][1]):DOM.html("#J_item_pre_line","\u8bf7\u9009\u62e9\u4e3b\u56fe\u89c4\u683c"),limit=parseInt(limitNums[a]);var e=a+"_"+formats[a][d][0]+"_"+d+"_"+formats[a][d][1];DOM.val("#J_items_per_line",e);for(var f in list.savedPics)list.savedPics[f]=(list.savedPics[f]+"").replace(/_\d{2,3}x\d{2,3}\.jpg$/,"_2x2.jpg")}listParam.getDesignPics(protoId,a),list.preview()},getDesignPics:function(a,b){var c=function(a){list.designPics=a.payload},d=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},e="proto_id="+a+"&width="+b+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(getDesignPicsUrl).setMethod("POST").setHandle(c).setErrorHandle(d).setData(e).send()},changeMainSise:function(){var a=this.id,b=DOM.val("#J_frame_width");DOM.replaceClass(DOM.query("#J_mainSize"+b+" .J_Mwidth"),"on-center off-center","off-center"),DOM.replaceClass(DOM.parent(this),"on-center off-center","on-center"),DOM.val("#J_mian_size"+b,a),DOM.html("#J_item_pre_line",formats[b][a][1]);var c=b+"_"+formats[b][a][0]+"_"+a+"_"+formats[b][a][1];DOM.val("#J_items_per_line",c);for(var d in list.savedPics)list.savedPics[d]=(list.savedPics[d]+"").replace(/_\d{2,3}x\d{2,3}\.jpg$/,"_"+a+"x"+a+".jpg")},setAllTiny:function(a){var b=DOM.attr(a,"src"),c=DOM.val("#J_SetTinyLabels");DOM.hasClass(DOM.parent(a),"t-current")?(c=c.replace("#"+b,""),c=c.replace(b+"#",""),c=c.replace(b,""),DOM.removeClass(DOM.parent(a),"t-current"),DOM.addClass(DOM.parent(a),"e-current")):(c==""?c+=b:c+="#"+b,DOM.removeClass(DOM.parent(a),"e-current"),DOM.addClass(DOM.parent(a),"t-current")),DOM.val("#J_SetTinyLabels",c)}}},{requires:[]}),KISSY.add("page/mods/designControl",function(a,b,c){var a=KISSY,d=a.DOM,e=a.Event;return designControl={designPicPanel:null,currentDesignId:null,currentXmlPath:null,msg:null,initDesignFlag:!1,getDesignContent:function(a){if(KISSY.inArray(a,g_ds_del_list))return;var b=function(b){d.html("#J_DesignDiv_"+a,b.payload),d.css("#J_DesignDiv_"+a,"position","relative");var f=d.height(d.get("#J_DesignDiv_"+a+" img")),g=d.width(d.get("#J_DesignDiv_"+a+" img"));d.css("#J_DesignDiv_"+a,"height",f),d.css("#J_DesignDiv_"+a+" div","height",f);var h=d.get("#J_DesignDiv_"+a);c.init(h),e.on("#J_DesignDiv_"+a+" .ds-bar-edit","click",function(b){designControl.showDesign("J_DesignDiv_"+a)}),e.on("#J_DesignDiv_"+a+" .ds-bar-del","click",function(b){var c=d.get("#J_DesignDiv_"+a),e=d.attr(c,"newid"),f,g={width:"0px",height:"0px",opacity:"0"};f=new KISSY.Anim(c,g,.3,KISSY.Easing.easeOut,function(){c.innerHTML="",c.parentNode.removeChild(c),g_ds_del_list.push(e)}),f.run()})},f=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error",autoClose:!0,timeOut:3e3})},g=list.designPics[a].designId,h="designId="+g+"&form_key="+FORM_KEY;(new H.widget.asyncRequest).setURI(getDesignContentUrl).setMethod("POST").setHandle(b).setErrorHandle(f).setData(h).send()},showDesign:function(a){designControl.currentDesignId=a.substr(12);var c=list.designPics[designControl.currentDesignId].designId,e=list.designPics[designControl.currentDesignId].xml_path,f={allowScriptAccess:"always",allowFullScreen:!0,base:"http://img01.huanleguang.com/main/"},g={mode:"7",designId:c,sid:sid,xmlUrl:e,saveNew:"yes",protoId:protoId};designControl.initDesignFlag?designControl.thisMovie("hlgFlash").initDesign(g):swfobject.embedSWF("http://img01.huanleguang.com/main/Main.swf?v=50","hlgFlash","1080","475","7","expressInstall.swf",g,f),designControl.designPicPanel||(designControl.designPicPanel=new b.Dialog({width:1080,headerContent:"\u7f16\u8f91\u4e3b\u56fe\u4fc3\u9500\u56fe\u6807",bodyContent:"",mask:!1,align:{points:["cc","cc"]},closable:!0,draggable:!0,aria:!0}),designControl.designPicPanel.set("bodyContent",KISSY.clone(d.get("#hlgFlash"))),designControl.designPicPanel.on("hide",function(){d.get("#J_design_icon_panel").style.display="none",d.get("#hlgFlash").style.visibility="hidden"})),designControl.designPicPanel.show(),designControl.designPicPanel.get("el").attr("id","J_design_icon_panel"),d.get("#J_design_icon_panel").style.display="block"},thisMovie:function(a){return navigator.appName.indexOf("Microsoft")!=-1?window[a]:document[a]},designFinish:function(a,b,c){if(a!=null&&b!=null&&c!=null){var e=designControl.currentDesignId;list.designPics[e].designId=b,list.designPics[e].xml_path=c,designControl.getDesignContent(e)}d.get("#hlgFlash").style.visibility="hidden",designControl.designPicPanel.hide()}}},{requires:["overlay","./tshop"]}),KISSY.add("page/design-init",function(S,showPages,O,TShop,ListParam,designControl){var DOM=S.DOM,Event=S.Event;return list={tbItem:[],selectItem:eval("("+itemsJson+")"),preSelectItem:[],savedPics:[],defaultItemFieldNames:{},defaultItemParams:eval("("+defaultItemParamsJson+")"),defaultRateMess:{buyer_nick:"",buyer_level:"",content:""},listParams:eval("("+listParamsJson+")"),designPics:eval("("+designPicsJson+")"),selectBoxPageNum:100,paginator:null,selectPaginator:null,panel:null,confirmPanel:null,rate:1,specRate:1,pageNum:10,msg:null,editFlag:!1,initPreSelectTag:!1,meal_price:{},meal_discount:{},meal_save:{},meal_meal_price:{},meal_url:{},lastedMealOffset:null,mealPageId:1,mealPaginator:null,mealPageNum:5,meals:[],useMeal:!1,init:function(){S.each(list.defaultItemParams,function(a){list.defaultItemFieldNames[a.field_code]=a.field_name}),ListParam.init();if(DOM.hasClass("#body-html","w-1000")){var str='<select id="J_SelectItemPage" name="Page"><option selected="selected" value="10">10\u6761</option><option value="20">20\u6761</option><option value="30">30\u6761</option><option value="40">40\u6761</option><option value="50">50\u6761</option><option value="100">100\u6761</option></select>';DOM.html("#J_SelectPage",str)}else{var str='<select id="J_SelectItemPage" name="Page"><option selected="selected" value="12">12\u6761</option><option value="24">24\u6761</option><option value="36">36\u6761</option><option value="48">48\u6761</option><option value="60">60\u6761</option></select>';DOM.html("#J_SelectPage",str)}if(cid=="27"||hand_img_url=="1")for(var k=0;k<list.selectItem.length;k++){var tempItem=list.selectItem[k];list.savedPics[tempItem.id]=tempItem.pic_url}window.iconTabs=(new S.Tabs("#J_main",{navCls:"ks-switchable-nav",contentCls:"main-content",activeTriggerCls:"current",triggerType:"click"})).on("switch",function(a){var b=a.currentIndex;switch(b){case 0:DOM.show("#J_Preview_Box"),Event.remove("#J_SaveBtn"),DOM.replaceClass(DOM.get("#J_SaveBtn"),"btm-gray-xiayibu btm-orange-baocun","btm-orange-xiayibu"),Event.on("#J_SaveBtn","click",function(){list.preview(),iconTabs.switchTo(1),list.useMeal&&meal_id!="0"&&new H.widget.msgBox({title:"\u6e29\u99a8\u63d0\u793a",content:"\u60a8\u5df2\u5f00\u901a\u5b98\u65b9\u642d\u914d\u5957\u9910\u670d\u52a1\uff0c\u53ef\u4ee5\u5728\u4e0b\u65b9\u9009\u62e9\u5b98\u65b9\u642d\u914d\u5957\u9910\uff01",type:"confirm",buttons:[{value:"\u660e\u767d"}],success:function(a){}})}),Event.remove("#J_PreviewBtn"),list.preSelectItem.length>0||list.selectItem.length>0?(Event.on("#J_PreviewBtn","click",function(){list.preview()}),DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan")):DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-orange-yulan","btm-gray-yulan");break;case 1:DOM.show("#J_Preview_Box"),list.renderItems(list.tbItem),Event.remove("#J_SaveBtn"),DOM.replaceClass(DOM.get("#J_SaveBtn"),"btm-gray-xiayibu btm-orange-baocun","btm-orange-xiayibu"),Event.on("#J_SaveBtn","click",function(){list.addItems(),list.preview(),list.renderSelectItems(1),iconTabs.switchTo(2)}),Event.remove("#J_PreviewBtn"),list.preSelectItem.length>0||list.selectItem.length>0?(Event.on("#J_PreviewBtn","click",function(){list.preview()}),DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan")):DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-orange-yulan","btm-gray-yulan");break;case 2:mtype==7&&(meal_id!="0"?DOM.hide(".status-pendding"):DOM.show(".status-pendding")),Event.remove("#J_SaveBtn"),DOM.replaceClass(DOM.get("#J_SaveBtn"),"btm-gray-xiayibu btm-orange-xiayibu","btm-orange-baocun"),Event.remove("#J_PreviewBtn"),list.selectItem.length>0?(Event.on("#J_PreviewBtn","click",function(){list.tempSave(),list.preview()}),Event.on("#J_SaveBtn","click",function(){list.tempSave(),list.save()}),DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan")):(DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-orange-yulan","btm-gray-yulan"),DOM.hide("#J_Preview_Box"))}}),mtype==7?(list.meals=eval("("+mealListJson+")"),list.meals.length>0&&(listId=="0"?list.useMeal=!0:meal_id!="0"&&(list.useMeal=!0)),list.getMeals(),list.getMealParam()):(DOM.hide(".J_TurnTbItemButt"),DOM.hide(".J_TurnMealButt"),DOM.hide("#J_TurnSelItemLi")),list.searchTbItems(),DOM.show("#J_ShowTbItemDiv"),list.selectItem.length>0&&(list.renderSelectItems(1,!0),list.editFlag=!0),Event.on("#J_SearchBtn","click",list.searchTbItems),Event.on("#J_ListBoxToggle","click",list.toggle),Event.on(".J_TurnTbItemButt","click",function(){meal_id="0",list.selectItem=[],list.preSelectItem=[],list.searchTbItems(),list.renderSelectItems(),DOM.hide("#J_ShowMealDiv"),DOM.show("#J_ShowTbItemDiv")}),Event.on(".J_TurnMealButt","click",function(){if(list.meals.length==0){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u60a8\u672a\u5f00\u901a\u5b98\u65b9\u642d\u914d\u5957\u9910\u670d\u52a1\u6216\u8005\u6ca1\u6709\u642d\u914d\u5957\u9910\uff01",type:"error"});return}var a=list.meals,b=!1,c="";for(var d=0;d<a.length;d++){if(a[d].item_list.length==limit){b=!0;break}c+=a[d].item_list.length+","}var e=new RegExp(",$","g");c=c.replace(e,"");if(!b){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u60a8\u9009\u4e2d\u7684\u6a21\u677f\u89c4\u683c\u652f\u6301\u7684\u5b9d\u8d1d\u6570\u4e3a:"+limit+"\u4e2a,\u4e0e\u60a8\u7684\u5b98\u65b9\u642d\u914d\u5957\u9910\u652f\u6301\u7684\u5b9d\u8d1d\u6570("+c+")\u4e0d\u7b26!\u8bf7\u8fd4\u56de\u7b2c\u4e8c\u6b65\u9009\u62e9\u5408\u9002\u7684\u201c\u89c4\u683cx\u5bbd\u5ea6x\u4e2a\u6570\u201d",type:"confirm",buttons:[{value:"\u8fd4\u56de\u7b2c\u4e8c\u6b65"},{value:"\u53d6\u6d88"}],success:function(a){a=="\u8fd4\u56de\u7b2c\u4e8c\u6b65"&&iconTabs.switchTo(0)}});return}list.selectItem=[],list.preSelectItem=[],list.lastedMealOffset!=null&&(meal_id=list.meals[list.lastedMealOffset].meal_id,list.addMeal(list.lastedMealOffset)),list.preview(),list.renderSelectItems(),DOM.hide("#J_ShowTbItemDiv"),DOM.show("#J_ShowMealDiv")}),Event.on("#J_NavDisabled","click",function(){iconTabs.switchTo(1)}),DOM.replaceClass(DOM.get("#J_SaveBtn"),"btm-gray-xiayibu","btm-orange-xiayibu"),Event.on("#J_SaveBtn","click",function(){list.preview(),iconTabs.switchTo(1)}),Event.on("#J_PreviewBtn","click",function(){list.subListParam()})},setAllItems:function(){var a=list.selectItem,b=a.length;if(b==0)return;var c=[];S.each(DOM.query(".J_SetAllItem"),function(a){var b={};b.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),b.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),b.value=DOM.val(DOM.get(".J_Param_Value",a)),b.field_name=list.defaultItemFieldNames[b.field_code],c.push(b)});for(var d=0;d<b;d++)id=a[d].id,a[d].item_params=c;list.selectItem=a,list.renderSelectItems(1),new H.widget.msgBox({type:"sucess",dialogType:"msg",content:"\u8bbe\u7f6e\u6210\u529f",autoClose:!0,timeOut:3e3}),list.preview()},initPreSelectItem:function(){if(list.initPreSelectTag)return;if(list.selectItem.length==0){if(mtype=="7")var a=parseInt(limit);else if(irregular=="1")var a=limit;else var a=1;for(i=0;i<a;i++)if(list.tbItem[i]){var b=list.tbItem[i],c={id:b.num_iid,title:b.title,promo_title:b.title,price:b.price,spec_price:b.price,volume:0,pic_url:b.pic_url,order:99};c.item_params=list.defaultItemParams,c.rate_ids="",list.preSelectItem.push(c);if(hand_img_url=="1"&&cid!="27"){var d=DOM.val("#J_items_per_line").split("_"),e=d[2],f="_"+e+"x"+e+".jpg";list.savedPics[c.id]=c.pic_url+f}}}list.initPreSelectTag=!0,list.preview()},getMealParam:function(){for(k=1;k<=5;k++){var a=DOM.get("#J_list_param"+k);if(a)switch(a.title){case"\u5957\u9910\u539f\u4ef7":list.meal_price=a;break;case"\u5957\u9910\u6298\u6263":list.meal_discount=a;break;case"\u8282\u7701\u7684\u94b1":list.meal_save=a;break;case"\u5957\u9910\u73b0\u4ef7":list.meal_meal_price=a;break;case"\u5957\u9910\u94fe\u63a5":list.meal_url=a}}},selectMeal:function(a){var b=list.meals[a];if(meal_id==b.meal_id)return;if(b.item_list.length!=limit){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u60a8\u9009\u4e2d\u7684\u6a21\u677f\u89c4\u683c\u652f\u6301\u7684\u5b9d\u8d1d\u6570\u4e3a:"+limit+"\u4e2a!",type:"error",autoClose:!0,timeOut:1e3});return}list.selectItem=[],list.preSelectItem=[],list.addMeal(a),meal_id=b.meal_id,list.lastedMealOffset=a,DOM.replaceClass(".J_DapeiTaocan","chosen","choose"),DOM.replaceClass("#J_DapeiTaocan_"+a,"choose","chosen"),list.preview()},addMeal:function(a){var b=list.meals[a];for(j=0;j<b.item_list.length;j++){var c=b.item_list[j],d={id:c.id,title:c.title,promo_title:c.promo_title,price:c.price,spec_price:c.price,volume:c.volume,pic_url:c.pic_url,order:c.order};d.item_params=list.defaultItemParams,d.rate_ids="",list.selectItem.push(d)}list.meal_price.value=b.price,list.meal_discount.value=b.discount,list.meal_save.value=b.save,list.meal_meal_price.value=b.meal_price,list.meal_url.value=b.url},getMeals:function(){var a=function(a){var b=list.mealPageNum*(a-1),c=list.mealPageNum*a;c>list.meals.length&&(c=list.meals.length);var d='<div class="clear"></div>';d+='<div class="dapeitaocan m-auto">';for(i=b;i<c;i++){var e=list.meals[i],f=e.item_list,g=f.length;e.status!="VALID"?d+='<div id="J_DapeiTaocan_'+i+'" class="J_DapeiTaocan m-auto mt15 choose-fail relative" style="*zoom:1">':e.meal_id==meal_id?d+='<div id="J_DapeiTaocan_'+i+'" class="J_DapeiTaocan m-auto mt15 chosen relative" style="*zoom:1">':d+='<div id="J_DapeiTaocan_'+i+'" class="J_DapeiTaocan m-auto mt15 choose relative" style="*zoom:1">',d+='<div class="taocan-choose fl relative" style="height:240px;">',d+='<div class="taocan-content">',d+='<span style=" padding:10px 0 0 0; color:#666; display:block">\u5957\u9910\u540d\u79f0\uff1a'+e.meal_name+"</span><br/>",d+="\u539f\u4ef7\uff1a"+e.price+"<br/>\u73b0\u4ef7\uff1a"+e.meal_price+"<br/> \u5f53\u524d\u72b6\u6001\uff1a",e.status!="VALID"?d+="\u65e0\u6548":d+="\u6709\u6548",d+="<br/>",d+="</div>",d+='<div class="taocan-btm btm-style-1">',d+='<span class="m-auto background-FFF"><a onclick="list.selectMeal('+i+')" href="#2"><font>\u9009\u62e9\u6b64\u5957\u9910</font></a></span>',d+="</div>",d+='<div class="taocan-btm btm-style-2">',d+='<span class="m-auto background-FFF"><a href="#2"><font>\u5df2\u9009\u62e9\u5957\u9910</font></a></span>',d+="</div>",d+='<div class="taocan-btm btm-style-3">',d+='<span class="m-auto background-FFF"><a href="#2"><font>\u4e0d\u53ef\u9009\u5957\u9910</font></a></span>',d+="</div>",d+='<div class="float-img"></div>',d+="</div>",d+='<div class="taocan-list fl">',d+="<ul>";for(j=0;j<g;j++){var h=f[j];d+='<li class="w-153">',d+='<div class="baobei-img-h-140 center">',d+='<a href="http://item.taobao.com/item.htm?id='+h.id+'" target="_blank">',d+='<img border="0" src="'+h.pic_url+'_120x120.jpg">',d+="</a></div>",d+='<div class="text"> ',d+='<a target="_blank" href="http://item.taobao.com/item.htm?id='+h.id+'" style="text-decoration:none"><span style="color:#666666">'+h.title+"</span></a>",d+="</div>",d+='<span class="price">\uffe5<span style="color:#ff0000; font-weight:bold">'+h.price+"</span></span>",d+="</li>"}d+='<div class="clear"></div>',d+="</ul>",d+="</div>",d+='<div class="opacity"></div>',d+='<div class="success-img"></div>',d+='<div class="clear"></div>',d+="</div>"}d+="</div>",DOM.html("#J_MealContainer",d)},b=function(b){a(b),list.mealPaginator.setPage(b).printHtml("#J_MealBottomPaging",2),list.mealPaginator.setPage(b).printHtml("#J_MealTopPaging",3)},c=Math.ceil(list.meals.length/list.mealPageNum);list.mealPaginator=(new showPages("list.mealPaginator")).setRender(b).setPageCount(c).printHtml("#J_MealBottomPaging",2),list.mealPaginator.printHtml("#J_MealTopPaging",3),b(list.mealPageId)},initPreMealItem:function(){if(list.initPreSelectTag)return;var a=list.meals,b=a.length;if(meal_id!="0"){for(i=0;i<b;i++)if(a[i].meal_id==meal_id){list.lastedMealOffset=i,list.mealPageId=Math.ceil((i+1)/list.mealPageNum);break}}else for(i=0;i<b;i++)if(a[i].status=="VALID"&&a[i].item_list.length==parseInt(limit)){list.addMeal(i),list.lastedMealOffset=i,meal_id=a[i].meal_id,list.mealPageId=Math.ceil((i+1)/list.mealPageNum);break}list.initPreSelectTag=!0},searchTbItems:function(){var a=function(a){totalRecords=a.payload.totalRecords,list.tbItem=a.payload.items,DOM.get("#J_NoteIcon").style.display="none",totalRecords>0?(DOM.get("#J_LEmpty").style.display="none",DOM.css(DOM.query(".J_ItemSelectBtnHolder"),"display","")):(DOM.get("#J_LEmpty").style.display="",DOM.css(DOM.query(".J_ItemSelectBtnHolder"),"display","none")),pageCount=Math.ceil(totalRecords/a.payload.pageNum),list.renderItems(a.payload.items);var b=function(a){pageId=a;var b=function(a){list.tbItem=a.payload.items,totalRecords=a.payload.totalRecords,totalRecords>0?(DOM.get("#J_NoteIcon").style.display="none",DOM.get("#J_LEmpty").style.display="none",DOM.css(DOM.query(".J_ItemSelectBtnHolder"),"display","")):(DOM.get("#J_LEmpty").style.display="",DOM.css(DOM.query(".J_ItemSelectBtnHolder"),"display","none")),pageCount=Math.ceil(totalRecords/a.payload.pageNum),list.renderItems(a.payload.items),DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent"),list.paginator.setPage(pageId).setPageCount(pageCount).printHtml("#J_TopPaging",3),list.paginator.setPage(pageId).setPageCount(pageCount).printHtml("#J_BottomPaging",2)};if(DOM.val(DOM.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u5546\u54c1\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var c=encodeURIComponent(DOM.val(DOM.get("#J_SearchTitle")));else var c="";var d=DOM.val(DOM.get("#J_SelectItemCid")),e=DOM.val(DOM.get("#J_SearchSelling")),f=DOM.val(DOM.get("#J_SelectItemOrder")),g=DOM.val(DOM.get("#J_SelectItemPage")),h=DOM.val(DOM.get("#J_PromoId")),i=DOM.val(DOM.get("#J_StartPrice")),j=DOM.val(DOM.get("#J_EndPrice")),k="q="+c+"&cid="+d+"&type="+e;k+="&start_price="+i+"&end_price="+j,k+="&itemOrder="+f+"&pageSize="+g+"&pid="+h+"&page_id="+pageId,DOM.show("#J_LeftLoading"),DOM.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(getItemsFromTbUrl).setMethod("GET").setHandle(b).setData(k).send()};list.paginator=(new showPages("list.paginator")).setRender(b).setPageCount(pageCount).printHtml("#J_TopPaging",3),list.paginator.printHtml("#J_BottomPaging",2),DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent"),list.initPreSelectItem()},b=function(a){DOM.hide("#J_LeftLoading"),DOM.show("#J_MainLeftContent"),new H.widget.msgBox({dialogType:"loading",content:a.desc})};if(DOM.val(DOM.get("#J_SearchTitle"))!="\u5173\u952e\u5b57\u3001\u5546\u54c1\u94fe\u63a5\u3001\u5546\u54c1\u7f16\u7801")var c=encodeURIComponent(DOM.val(DOM.get("#J_SearchTitle")));else var c="";var d=DOM.val(DOM.get("#J_SelectItemCid")),e=DOM.val(DOM.get("#J_SearchSelling")),f=DOM.val(DOM.get("#J_SelectItemOrder")),g=DOM.val(DOM.get("#J_SelectItemPage")),h=DOM.val(DOM.get("#J_PromoId")),i=DOM.val(DOM.get("#J_StartPrice")),j=DOM.val(DOM.get("#J_EndPrice")),k="q="+c+"&cid="+d+"&type="+e;k+="&start_price="+i+"&end_price="+j,k+="&itemOrder="+f+"&pageSize="+g+"&pid="+h,DOM.show("#J_LeftLoading"),DOM.hide("#J_MainLeftContent"),(new H.widget.asyncRequest).setURI(getItemsFromTbUrl).setMethod("GET").setHandle(a).setErrorHandle(b).setData(k).send()},renderItems:function(a){var b=a.length;DOM.attr("#J_TCheckAll","checked",!1);var c="";for(var d=0;d<b;d++){var e="",f="",g=!1;list.hasSelected(a[d].num_iid)?(g=!0,e='disabled="disabled" checked="checked"',f="uncheck"):list.hasPreSelected(a[d].num_iid)&&(g=!0,e='checked="checked"',f="selected"),c+='<li class="w-172 J_TbItem relative '+f+'" id="J_TbItem_'+a[d].num_iid+'">'+'<input type="hidden" id="" value="">'+'<div class="baobei-img baobei-img-h-160">'+'<a target="_blank" href="http://item.taobao.com/item.htm?id='+a[d].num_iid+'" class="w-160">'+'<img border="0"  src="'+a[d].pic_url+'_120x120.jpg" width="120" height="120">'+"</a>"+"</div>"+'<div class="baobei-text">'+'<a target="_blank" style="text-decoration:none" class="" href="http://item.taobao.com/item.htm?id='+a[d].num_iid+'">'+'<span class="inline-block baobei-info">'+a[d].title+"</span>"+'</a><span class="fl inline-block w-150">\uffe5<b class="color-red">'+a[d].price+"</b></span>"+"</div>"+'<div class="ol-base"></div><div class="ol-mouseover"><div class="border"><span class="ol-text-ext">\u70b9\u51fb\u9009\u62e9</span></div></div><div class="ol-click"><div class="ol-img-checked"></div><span class="ol-text-ext">\u70b9\u51fb\u53d6\u6d88</span><br/><a href="http://item.taobao.com/item.htm?id='+a[d].num_iid+'"target="_blank"><span class="ol-img-view"></span></a></div><div class="ol-uncheck"><span class="ol-text-ext">\u5df2\u52a0\u5165\u6d3b\u52a8<br/></span><a href="http://item.taobao.com/item.htm?id='+a[d].num_iid+'"target="_blank"><span class="ol-img-view"></span></a></div>',g?c+='<span class="fl" style="display:none"><input type="checkbox"  id="J_CheckBox_'+a[d].num_iid+'" '+e+' class="J_CheckBox" name="selectedIds" value="'+a[d].num_iid+'">&nbsp;\u9009\u62e9</span>':c+='<span class="fl" style="display:none"><input type="checkbox"  id="J_CheckBox_'+a[d].num_iid+'"  class="J_CheckBox" name="selectedIds" value="'+a[d].num_iid+'">&nbsp;\u9009\u62e9</span>',c+="</li>"}DOM.html(DOM.get("#J_ItemDataTable"),c);var h=DOM.query("#J_ItemDataTable .J_TbItem");Event.on(h,"mouseenter mouseleave click",function(a){var b=DOM.get(".J_CheckBox",a.currentTarget);if(b.disabled)return;a.type=="mouseenter"?DOM.addClass(a.currentTarget,"mouseover"):a.type=="mouseleave"?DOM.removeClass(a.currentTarget,"mouseover"):a.type=="click"&&(b.checked==0?list.addPreItem(a.currentTarget.id):list.removePreItem(a.currentTarget.id),Event.remove("#J_PreviewBtn"),list.preSelectItem.length>0||list.selectItem.length>0?(Event.on("#J_PreviewBtn","click",function(){list.preview()}),DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan")):DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-orange-yulan","btm-gray-yulan"))}),Event.on(DOM.query("#J_ItemDataTable .J_CheckBox"),"click",function(a){a.stopPropagation();var b=a.currentTarget.value;a.currentTarget.checked==1?DOM.addClass("#J_TbItem_"+b,"seleted"):DOM.removeClass("#J_TbItem_"+b,"seleted")})},renderSelectItems:function(a,b){items=list.selectItem,pageNum=list.selectBoxPageNum;var c=items.length;c<pageNum&&(pageNum=c);var d=c-(a-1)*pageNum-1,e=c-a*pageNum;e<0&&(e=0);var f="";flag=0;var g="",h="";for(var i=e;i<=d;i++){g="",h="",flag++,b?(order=items[i].order,specPrice=items[i].spec_price):(order=(a-1)*pageNum+flag,items[i].spec_price==undefined?specPrice=items[i].price:specPrice=items[i].spec_price);if(cid=="27"||hand_img_url=="1")list.savedPics[items[i].id]&&(h=list.savedPics[items[i].id]),g='<li class="clear w-280" style="padding:0px 0px 5px 0px;"><div class="active-add-edit-title w-80">\u5b9d\u8d1d\u4e3b\u56fe\uff1a</div><div class="active-add-edit-edit"><input type="text" title="baobeiPic" id="J_PicUrl_'+items[i].id+'" value="'+h+'" name="picUrl" class="input-text w-180">&nbsp;<b style="color:#F00; vertical-align:middle">*</b>'+"</div></li>"+'<li class="clear w-280" style="padding:0px 0px 5px 0px;">'+'<div class="active-add-edit-title w-80">&nbsp;</div>'+'<div class="active-add-edit-edit">'+'<p style="color: #FB8534;">\u590d\u5236\u56fe\u7247\u7a7a\u95f4\u5ba1\u6838\u8fc7\u7684\u4e3b\u56fe\u5730\u5740</p>'+"</div></li>";f+='<li class="list-item border-e4e4e4-b-d"><div class="list-div"><ul class="wc-detail-area"><li style="width:8%;"><input type="text" class="input-text w-30" id="J_Order_'+items[i].id+'" name="order"  value="'+order+'" >'+"</li>"+'<li style="width:10%;">'+'<a title="'+items.title+'" href="http://item.taobao.com/item.htm?id='+items[i].id+'" target="_blank">',hand_img_url=="1"?f+='<img width="60" height="60" src="'+items[i].pic_url+'">':f+='<img width="60" height="60" src="'+items[i].pic_url+'_60x60.jpg">',f+='</a></li><li style="width:45%;"><div class="item-box"><ul><li class="clear w-280" style="padding:0px 0px 5px 0px;"><div class="active-add-edit-title w-80">\u6807\u9898\uff1a</div><div class="active-add-edit-edit"><input type="hidden" class="text text-long" id="J_Title_'+items[i].id+'" value="'+items[i].title+'">'+'<input type="text" class="input-text w-170" title="Title" id="J_PromoTitle_'+items[i].id+'" value="'+items[i].promo_title+'" >'+'</div></li><li class="clear w-280" style="padding:0px 0px 5px 0px;"><div class="active-add-edit-title w-80">\u539f\u4ef7\uff1a</div>'+'<div class="active-add-edit-edit">'+'<input type="text" title="price" name="price" id="J_Price_'+items[i].id+'" value="'+items[i].price+'" class="input-text w-170">'+"</div></li>"+'<li class="clear w-280" style="padding:0px 0px 5px 0px;">'+'<div class="active-add-edit-title w-80">\u7279\u4ef7\uff1a</div>'+'<div class="active-add-edit-edit">'+'<input type="text" title="specPrice" id="J_SpecPrice_'+items[i].id+'" value="'+specPrice+'" name="specPrice" class="input-text w-170">'+"</div></li>"+g+"</ul></div></li>"+'<li style="width:37%;" id="J_ItemParams_'+items[i].id+'">'+'<div class="item-box">'+"<ul>",oriPriceWriterHtml="",curPriceWriterHtml="",tinyLabelsHtml="",itemParam1Html="",itemParam2Html="",itemParam3Html="",itemParam4Html="",itemParam5Html="",itemParam6Html="";var j=items[i].item_params;S.each(j,function(a){a["field_code"]=="ori_price_writer"&&(oriPriceWriterHtml+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams w-330 clear"> <div class="active-add-edit-title w-90">\u539f\u4ef7\u6587\u6848\uff1a</div><div class="active-add-edit-edit"><div class="fl"><input type="text" id ="J_oriPriceWriter'+items[i].id+'" name="ori_price_writer" value="'+a.value+'" title="ori_price_writer" class="J_Param_Value input-text w-100">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></td>'+' <div style="padding-left:5px;" class="fl">'+'<select id="J_OPrice_'+items[i].id+'" name="oripricewriter" onchange="KISSY.DOM.val(\'#J_oriPriceWriter'+items[i].id+"',this.value)\">",paramOptons.ori_price_writer&&S.each(paramOptons.ori_price_writer,function(a){oriPriceWriterHtml+='<option value="'+a+'">'+a+"</option>"}),oriPriceWriterHtml+="</select></div></div></li>"),a["field_code"]=="cur_price_writer"&&(curPriceWriterHtml+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams w-330 clear"><div class="active-add-edit-title w-90 ">\u73b0\u4ef7\u6587\u6848\uff1a</div><div class="active-add-edit-edit"><div class=" fl"><input type="text" id ="J_curPriceWriter'+items[i].id+'" name="cur_price_writer" value="'+a.value+'" title="cur_price_writer" class="J_Param_Value input-text w-100">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></td>'+' <div class="fl" style="padding-left:5px;">'+'<select id="J_CPrice_'+items[i].id+'" name="curpricewriter" onchange="KISSY.DOM.val(\'#J_curPriceWriter'+items[i].id+"',this.value)\">",paramOptons.cur_price_writer&&S.each(paramOptons.cur_price_writer,function(a){curPriceWriterHtml+='<option value="'+a+'">'+a+"</option>"}),curPriceWriterHtml+="</select></div></div></li>");if(a["field_code"]=="tiny_labels"){var b=a.value.split("#");tinyLabelsHtml+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams "><div class="active-add-edit-title w-90">\u5c0f\u6807\u7b7e\uff1a</div><div class="active-add-edit-edit"><input type="hidden" class="J_Param_Value" id ="J_TinyLabels'+items[i].id+'"value="'+a.value+'"/><input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/>',paramOptons.tiny_labels&&S.each(paramOptons.tiny_labels,function(a){tinyLabelsHtml+='<a href="#2"',S.each(b,function(b){b!=""&&b==a&&(tinyLabelsHtml+='class="t-current"')}),tinyLabelsHtml+='><img src="'+a+'" class="J_TinyLabels" onClick="var elem = this;list.selectTiny(elem)" data="'+items[i].id+'"/></a>&nbsp;&nbsp;'}),tinyLabelsHtml+="</div></li>"}a["field_code"]=="item_param1"&&(itemParam1Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param1" value="'+a.value+'" title="item_param1" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>'),a["field_code"]=="item_param2"&&(itemParam2Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param2" value="'+a.value+'" title="item_param2" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>'),a["field_code"]=="item_param3"&&(itemParam3Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param3" value="'+a.value+'" title="item_param3" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>'),a["field_code"]=="item_param4"&&(itemParam4Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param4" value="'+a.value+'" title="item_param4" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>'),a["field_code"]=="item_param5"&&(itemParam5Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param5" value="'+a.value+'" title="item_param5" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>'),a["field_code"]=="item_param6"&&(itemParam6Html+='<li style="padding:0px 0px 5px 0px;" class="J_ItemParams"><div class="active-add-edit-title w-90">'+list.defaultItemFieldNames[a.field_code]+"\uff1a</div>"+'<div class="active-add-edit-edit"><input type="text"  name="item_param6" value="'+a.value+'" title="item_param6" class="J_Param_Value input-text w-170">'+'<input type="hidden" class="J_Param_ParamId" value="'+a.param_id+'"/><input type="hidden" class="J_Param_FieldCode" value="'+a.field_code+'"/></div></li>')}),f+=oriPriceWriterHtml+curPriceWriterHtml+tinyLabelsHtml+itemParam1Html+itemParam2Html+itemParam3Html+itemParam4Html+itemParam5Html+itemParam6Html,f+="</ul></div></li></ul>",f+='<div class="wc-operate-area" style="padding-top:13px;">',hasRate&&(items[i].rate_ids==undefined&&(items[i].rate_ids=""),f+='<div><input type="hidden" id="J_RateMess_'+items[i].id+'" value="'+items[i].rate_ids+'"/>'+'<a href="#2" onclick="H.rateControl.showItemRates('+items[i].id+')">\u8bbe\u7f6e\u5b9d\u8d1d\u8bc4\u4ef7</a></div>'),f+='<div  class="item-status"><div class="status-pendding"><a href="javascript:list.removeItem('+items[i].id+');"   title="\u4ece\u63a8\u8350\u5217\u8868\u5220\u9664\u4e2d">\u53d6\u6d88\u63a8\u8350</a></div></div>',f+="</li></ul></div></li>"}DOM.html(DOM.get("#J_SelectItemBox"),f),c>0?(DOM.hide("#J_RightEmpty"),DOM.css(DOM.query(".J_selectItemHoder"),"display","")):(DOM.show("#J_RightEmpty"),DOM.css(DOM.query(".J_selectItemHoder"),"display","none")),DOM.html("#J_AllItemParams")==""&&DOM.hide("#J_SelectItemParamBox"),(j==undefined||j.length==0)&&DOM.hide("#J_SelectItemParamBox");var k=DOM.filter(DOM.query("input"),function(a){if(a.type=="text")return!0});Event.on(k,"focus blur",function(a){a.type=="focus"?(DOM.removeClass(a.target,"input-text text text-error"),DOM.addClass(a.target,"input-text-on")):a.type=="blur"&&(DOM.removeClass(a.target,"input-text-on"),DOM.addClass(a.target,"input-text"))})},selectTiny:function(a){var b=DOM.attr(a,"data"),c=DOM.attr(a,"src"),d=DOM.val("#J_TinyLabels"+b);DOM.hasClass(DOM.parent(a),"t-current")?(d=d.replace("#"+c,""),d=d.replace(c+"#",""),d=d.replace(c,""),DOM.removeClass(DOM.parent(a),"t-current"),DOM.addClass(DOM.parent(a),"e-current")):(d==""?d+=c:d+="#"+c,DOM.addClass(DOM.parent(a),"t-current"),DOM.removeClass(DOM.parent(a),"e-current")),DOM.val("#J_TinyLabels"+b,d)},reInitSelectBox:function(){var a=list.selectItem.length,b=list.selectBoxPageNum;if(a>b){pageCount=Math.ceil(a/b);var c=function(a){pageId=a;var b=list.selectItem.length,c=Math.ceil(b/list.selectBoxPageNum);list.renderSelectItems(pageId),list.selectPaginator.setPage(pageId).setPageCount(c).printHtml("#J_BottomSelectPaging",2)};list.selectPaginator=(new showPages("list.selectPaginator")).setRender(c).setPageCount(pageCount).printHtml("#J_BottomSelectPaging",2)}list.renderSelectItems(1)},addItems:function(){var a=list.preSelectItem,b=a.length;b==0&&!list.editFlag&&new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u672a\u9009\u62e9\u5b9d\u8d1d",autoClose:!0,timeOut:1e3});for(i=0;i<b;i++){var c=a[i];DOM.show("#J_status_"+c.id),DOM.hide(DOM.prev("#J_status_"+c.id)),DOM.attr(DOM.get("#J_CheckBox_"+c.id),{disabled:"disabled",checked:"checked"}),c.item_params=list.defaultItemParams,c.rate_ids="",list.selectItem.push(c)}list.preSelectItem=[]},addPreItem:function(a){if(list.preSelectItem.length+list.selectItem.length>=limit){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u5217\u8868\u6570\u91cf\u8d85\u8fc7\u6a21\u677f\u9650\u5236\uff08"+limit+"\u4e2a\uff09",type:"error"});return}DOM.addClass("#"+a,"selected"),DOM.get(".J_CheckBox","#"+a).checked=!0;var b=a.substr(9);DOM.show("#J_status_"+b),DOM.hide(DOM.prev("#J_status_"+b)),DOM.attr(DOM.get("#J_CheckBox_"+b),{checked:"checked"});var c=list.tbItem,d=c.length;for(var e=0;e<d;e++)if(c[e].num_iid==b){var f={id:b,title:c[e].title,promo_title:c[e].title,price:c[e].price,spec_price:c[e].price,volume:0,pic_url:c[e].pic_url,order:99};c[e].spec_price&&(f.spec_price=c[e].spec_price),f.item_params=list.defaultItemParams,f.rate_ids="",list.preSelectItem.push(f);if(hand_img_url=="1"&&cid!="27"){var g=DOM.val("#J_items_per_line").split("_"),h=g[2],i="_"+h+"x"+h+".jpg";list.savedPics[b]=c[e].pic_url+i}break}DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan")},hasSelected:function(a){var b=list.selectItem,c=b.length;for(var d=0;d<c;d++)if(b[d].id==a)return!0;return!1},hasPreSelected:function(a){var b=list.preSelectItem,c=b.length;for(var d=0;d<c;d++)if(b[d].id==a)return!0;return!1},removePreItem:function(a){DOM.removeClass("#"+a,"selected"),DOM.get(".J_CheckBox","#"+a).checked=!1,DOM.attr("#J_TCheckAll","checked",!1);var b=a.substr(9),c=list.preSelectItem,d=c.length;for(var e=0;e<d;e++)if(c[e].id==b){list.preSelectItem.splice(e,1);break}},removeItem:function(a,b){DOM.removeClass("#J_TbItem_"+a,"selected"),DOM.get(".J_CheckBox","#J_TbItem_"+a)&&(DOM.get(".J_CheckBox","#J_TbItem_"+a).checked=!1),DOM.attr("#J_TCheckAll","checked",!1);var c=list.selectItem,d=c.length;for(var e=0;e<d;e++)if(c[e].id==a){list.selectItem.splice(e,1);break}list.renderSelectItems(1),list.preview(),list.selectItem.length<=0&&DOM.hide("#J_Preview_Box")},strProcess:function(a){return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/[\t\n&]/g,"%26").replace(/%/g,"%25")},subListParam:function(){list.preview()},preview:function(){if(iconTabs.activeIndex==2)var a=list.selectItem;else var a=list.selectItem.concat(list.preSelectItem);var b=a.length;if(b<=0)return DOM.hide("#J_ContentDetail"),DOM.hide("#J_ToggleC"),DOM.replaceClass(DOM.get("#J_PreviewBtn"),"btm-gray-yulan","btm-orange-yulan"),!1;DOM.show("#J_ContentDetail");if(iconTabs.activeIndex==1&&irregular=="1"&&b!=limit){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u6b64\u6a21\u677f\u4ec5\u652f\u6301("+limit+")\u4e2a\u5b9d\u8d1d\uff0c\u60a8\u5f53\u524d\u5df2\u9009\u4e2d("+b+")\u4e2a\u5b9d\u8d1d!",type:"error"});return}var c=list.generatePostItems(a),d=KISSY.JSON.stringify(c),e=new Array;S.each(DOM.query(".J_ListParams"),function(a,b){var c={};c.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),c.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),c.value=list.strProcess(DOM.val(DOM.get(".J_Param_Value",a))),c.value.indexOf("undefined")>=0&&(c.value=DOM.val("#J_items_per_line_default")),e.push(c)});var f=KISSY.JSON.stringify(e),g=function(a){DOM.html(DOM.get("#J_ContentDetail"),a.payload),DOM.show("#J_ToggleC");var b=S.one("#J_Preview_Box");b.css("display")==="none"&&b.slideDown(),S.each(DOM.query(".J_DesignDiv"),function(a){var b=a.id,c=b.substr(12);designControl.getDesignContent(c)})},h=function(a){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},i=[],j="";if(!KISSY.isEmptyObject(list.designPics)){S.each(list.designPics,function(a,b){i.push(b+","+a.designId)});if(KISSY.inArray(i[0].split(",")[0],g_ds_del_list))j+="designPics=[]";else{var i=KISSY.JSON.stringify(i);j+="designPics="+i}}else j+="designPics=[]";d=d.replace(/%25/g,"%!").replace(/&/g,"%26"),f=f.replace(/%25/g,"%!"),j+="&items="+d+"&listParams="+f+"&proto_id="+protoId+"&form_key="+FORM_KEY,(new H.widget.asyncRequest).setURI(previewUrl).setMethod("POST").setHandle(g).setErrorHandle(h).setData(j).send()},tempSave:function(){var a=list.selectItem,b=a.length;if(b==0)return;for(var c=0;c<b;c++){id=a[c].id,a[c].title=DOM.val(DOM.get("#J_Title_"+id)),a[c].promo_title=DOM.val(DOM.get("#J_PromoTitle_"+id)),a[c].price=DOM.val(DOM.get("#J_Price_"+id)),a[c].spec_price=DOM.val(DOM.get("#J_SpecPrice_"+id)),a[c].volume=DOM.val(DOM.get("#J_Volume_"+id)),a[c].order=DOM.val(DOM.get("#J_Order_"+id)),hasRate&&(a[c].rate_ids=DOM.val(DOM.get("#J_RateMess_"+id)));var d=[];S.each(DOM.query("#J_ItemParams_"+id+" .J_ItemParams"),function(a,b){var c={};c.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),c.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),c.value=DOM.val(DOM.get(".J_Param_Value",a)),c.field_name=list.defaultItemFieldNames[c.field_code],d.push(c)}),a[c].item_params=d}list.selectItem=a},checkAll:function(a){var b=DOM.query("#J_ItemDataTable .J_CheckBox"),c=b.length;for(i=0;i<c;i++){var d=b[i].value;if(b[i].disabled||b[i].selected)continue;list.addPreItem("J_TbItem_"+d)}},toggle:function(a){var b=S.one("#J_ListBox");b.css("display")==="none"?b.slideDown(.8,function(){DOM.html("#J_ListBoxToggle","\u9690\u85cf\u6a21\u7248\u9884\u89c8")}):b.slideUp(.8,function(){DOM.html("#J_ListBoxToggle","\u663e\u793a\u6a21\u7248\u9884\u89c8")})},generatePostItems:function(a,b){var c=new Array,d=a.length;for(var e=0;e<d;e++){var f={id:a[e].id,title:list.strProcess(a[e].title),promo_title:list.strProcess(a[e].promo_title),price:a[e].price,spec_price:a[e].spec_price,volume:a[e].volume,pic_url:a[e].pic_url,order:a[e].order,rate_ids:a[e].rate_ids};if(cid=="27"||hand_img_url=="1"){cid=="27"&&(f.pic_url=""),iconTabs.activeIndex==2&&(f.pic_url=DOM.val(DOM.get("#J_PicUrl_"+a[e].id)),list.savedPics[a[e].id]=f.pic_url);if(cid=="27"&&!b&&f.pic_url==""){f.pic_url=a[e].pic_url;if(hand_img_url=="1"){var g=DOM.val("#J_items_per_line").split("_"),h=g[2],i="_"+h+"x"+h+".jpg";i=="_220x220.jpg"&&(i="_b.jpg"),f.pic_url=f.pic_url+i}}if(cid!="27"&&hand_img_url=="1"||cid=="27"&&list.savedPics[a[e].id])f.pic_url=list.savedPics[a[e].id],f.pic_url=(f.pic_url+"").replace(/_220x220\.jpg$/,"_b.jpg")}var j=new Array,k=a[e].item_params;for(var l=0;l<k.length;l++){var m={param_id:k[l].param_id,field_code:k[l].field_code,value:list.strProcess(k[l].value),field_name:k[l].field_name};j.push(m)}f.item_params=j,c.push(f)}return c},save:function(){var a=list.selectItem,b=a.length;if(b==0){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u60a8\u8fd8\u6ca1\u6709\u9009\u62e9\u63a8\u8350\u5b9d\u8d1d\u54e6",type:"error"});return}if(irregular=="1"&&b!=limit){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u6b64\u6a21\u677f\u4ec5\u652f\u6301("+limit+")\u4e2a\u5b9d\u8d1d\uff0c\u60a8\u5f53\u524d\u5df2\u9009\u4e2d("+b+")\u4e2a\u5b9d\u8d1d!",type:"error"});return}if(cid=="27"||hand_img_url=="1")for(var c=0;c<b;c++)if(DOM.val(DOM.get("#J_PicUrl_"+a[c].id))==""){new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:"\u8bf7\u586b\u5199\u7b2c"+DOM.val(DOM.get("#J_Order_"+a[c].id))+"\u4e2a\u5b9d\u8d1d\u7684\u4e3b\u56fe\u5730\u5740",type:"error"});return}list.msg=new H.widget.msgBox({dialogType:"loading",content:"\u63d0\u4ea4\u4e2d\uff0c\u8bf7\u7a0d\u5019\uff01"});var d=list.generatePostItems(a,1),e=KISSY.JSON.stringify(d),f=new Array;S.each(S.all(".J_ListParams"),function(a,b){var c={};c.param_id=DOM.val(DOM.get(".J_Param_ParamId",a)),c.field_code=DOM.val(DOM.get(".J_Param_FieldCode",a)),c.value=list.strProcess(DOM.val(DOM.get(".J_Param_Value",a))),c.value.indexOf("undefined")>=0&&(c.value=DOM.val("#J_items_per_line_default")),f.push(c)});var g=KISSY.JSON.stringify(f),h=function(a){DOM.html(DOM.get("#J_ContentDetail"),a.payload.body),list.msg.hide(),listId=a.payload.list_id;var b=createUrl+"&listId="+listId;if(isVersionPer("material",!1))new H.widget.msgBox({title:"\u4fdd\u5b58\u6210\u529f",content:"\u4fdd\u5b58\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u53bb\u67e5\u770b\u5217\u8868\u6216\u8005\u5347\u7ea7\u5230\u5c0a\u4eab\u7248\u53bb\u6295\u653e",type:"confirm",buttons:[{value:"\u5347\u7ea7"},{value:"\u67e5\u770b\u5217\u8868"}],success:function(a){a=="\u5347\u7ea7"?isVersionPer("material"):window.location.href=listUrl}});else{if(list.editFlag==1)var c="\u91cd\u65b0\u6295\u653e";else var c="\u53bb\u6295\u653e ";new H.widget.msgBox({title:"\u4fdd\u5b58\u6210\u529f",content:"\u4fdd\u5b58\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u53bb\u67e5\u770b\u5217\u8868,\u6295\u653e\u5217\u8868",type:"confirm",buttons:[{value:c},{value:"\u67e5\u770b\u5217\u8868"},{value:"\u8fd4\u56de\u7f16\u8f91"}],success:function(a){a==c?window.location.href=b:a=="\u67e5\u770b\u5217\u8868"&&(window.location.href=listUrl)}})}},i=function(a){list.msg.hide(),new H.widget.msgBox({title:"\u9519\u8bef\u63d0\u793a",content:a.desc,type:"error"})},j="";mtype==7?j="&meal_id="+meal_id+"&":j="&meal_id=0&";var k=[];if(!KISSY.isEmptyObject(list.designPics)){S.each(list.designPics,function(a,b){k.push(b+","+a.designId)});if(KISSY.inArray(k[0].split(",")[0],g_ds_del_list))j+="designPics=[]";else{var k=KISSY.JSON.stringify(k);j+="designPics="+k}}else j+="designPics=[]";e=e.replace(/%25/g,"%!").replace(/&/g,"%26"),g=g.replace(/%25/g,"%!"),j+="&items="+e+"&listParams="+g+"&list_id="+listId+"&proto_id="+protoId+"&form_key="+FORM_KEY,(new H.widget.asyncRequest).setURI(saveUrl).setMethod("POST").setHandle(h).setErrorHandle(i).setData(j).send()},designFinish:function(a,b,c){designControl.designFinish(a,b,c)}}},{requires:["utils/showPages/index","overlay","./mods/tshop","./mods/listParam","./mods/designControl"]}); 